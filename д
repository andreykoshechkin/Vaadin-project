import java.math.BigDecimal;
import java.util.List;

public class ConditionHandlerChain {

    public Pair<Boolean, String> result(List<ClientInfo> clientInfo) {
        ConditionHandler typeHandler = new TypeConditionHandler();
        ConditionHandler kiGHandler = new KiGConditionHandler();
        ConditionHandler matrixHandler = new MatrixConditionHandler();

        typeHandler.setNext(kiGHandler).setNext(matrixHandler);

        boolean flag = typeHandler.handle(clientInfo);

        return Pair.of(flag, "msg");
    }
}

interface ConditionHandler {
    boolean handle(List<ClientInfo> clientInfo);
    ConditionHandler setNext(ConditionHandler nextHandler);
}

class TypeConditionHandler implements ConditionHandler {
    private ConditionHandler nextHandler;

    @Override
    public ConditionHandler setNext(ConditionHandler nextHandler) {
        this.nextHandler = nextHandler;
        return nextHandler;
    }

    @Override
    public boolean handle(List<ClientInfo> clientInfo) {
        boolean result = clientInfo.stream()
                .anyMatch(it -> it.getClientType().equals("ЮР") || it.getClientType().equals("ИП"));
        if (result && nextHandler != null) {
            return nextHandler.handle(clientInfo);
        }
        return result;
    }
}

class KiGConditionHandler implements ConditionHandler {
    private ConditionHandler nextHandler;

    @Override
    public ConditionHandler setNext(ConditionHandler nextHandler) {
        this.nextHandler = nextHandler;
        return nextHandler;
    }

    @Override
    public boolean handle(List<ClientInfo> clientInfo) {
        boolean result = !clientInfo.stream()
                .anyMatch(it -> it.getKiG().equals(BigDecimal.valueOf(545)) ||
                        it.getKiG().equals(BigDecimal.valueOf(546)) ||
                        it.getKiG().equals(BigDecimal.valueOf(547)));
        if (result && nextHandler != null) {
            return nextHandler.handle(clientInfo);
        }
        return result;
    }
}

class MatrixConditionHandler implements ConditionHandler {
    private ConditionHandler nextHandler;

    @Override
    public ConditionHandler setNext(ConditionHandler nextHandler) {
        this.nextHandler = nextHandler;
        return nextHandler;
    }

    @Override
    public boolean handle(List<ClientInfo> clientInfo) {
        boolean result = !clientInfo.stream()
                .anyMatch(it -> it.getKiG().equals(BigDecimal.valueOf(534)) ||
                        it.getKiG().equals(BigDecimal.valueOf(535)) ||
                        it.getKiG().equals(BigDecimal.valueOf(536)));
        if (result && nextHandler != null) {
            return nextHandler.handle(clientInfo);
        }
        return result;
    }
}

class ClientInfo {
    private String clientType;
    private BigDecimal kiG;

    public ClientInfo(String clientType, BigDecimal kiG) {
        this.clientType = clientType;
        this.kiG = kiG;
    }

    public String getClientType() {
        return clientType;
    }

    public BigDecimal getKiG() {
        return kiG;
    }
}
